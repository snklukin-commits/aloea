
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–∫—Ü–∏–∏ –°–¢–ú | –ê–ø—Ç–µ—á–Ω–∞—è —Å–µ—Ç—å –ê–õ–û–≠</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
background: linear-gradient(135deg, #e8f8f5 0%, #d4ede8 100%);
min-height: 100vh;
padding: 20px;
}
.container {
max-width: 1200px;
margin: 0 auto;
}
.header {
background: white;
border-radius: 16px;
padding: 40px;
text-align: center;
margin-bottom: 40px;
box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
animation: slideDown 0.6s ease;
}
.header-logo {
display: flex;
align-items: center;
justify-content: center;
gap: 20px;
margin-bottom: 20px;
}
.logo-img {
width: 80px;
height: 80px;
background: #f0f8f4;
border-radius: 12px;
display: flex;
align-items: center;
justify-content: center;
overflow: hidden;
}
.logo-img img {
max-width: 100%;
max-height: 100%;
object-fit: contain;
}
.header h1 {
color: #2c3e50;
font-size: 2.5rem;
margin-bottom: 10px;
font-weight: 700;
}
.header-stats {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 20px;
margin-top: 30px;
}
.stat-box {
background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
color: white;
padding: 20px;
border-radius: 12px;
text-align: center;
}
.stat-number {
font-size: 2rem;
font-weight: 700;
margin-bottom: 5px;
}
.stat-label {
font-size: 0.9rem;
opacity: 0.9;
}
.controls {
background: white;
border-radius: 12px;
padding: 20px;
margin-bottom: 30px;
display: flex;
gap: 10px;
flex-wrap: wrap;
justify-content: center;
box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}
.filter-btn {
padding: 10px 20px;
border: 2px solid #ecf0f1;
background: white;
border-radius: 8px;
cursor: pointer;
font-weight: 600;
transition: all 0.3s;
font-size: 0.9rem;
}
.filter-btn:hover {
border-color: #2ecc71;
color: #2ecc71;
}
.filter-btn.active {
background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
color: white;
border-color: transparent;
}
.print-btn {
padding: 10px 20px;
background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
color: white;
border: none;
border-radius: 8px;
cursor: pointer;
font-weight: 600;
font-size: 0.9rem;
transition: all 0.3s;
}
.print-btn:hover {
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
}
.promotions-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
gap: 30px;
margin-bottom: 40px;
animation: fadeIn 0.8s ease;
}
.promotions-grid.single-view {
grid-template-columns: 1fr;
}
.promotion-card {
background: white;
border-radius: 16px;
overflow: hidden;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
transition: all 0.3s;
border-left: 6px solid #2ecc71;
}
.promotion-card:hover {
transform: translateY(-5px);
box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
}
.promotion-card.type-1plus1 {
border-left-color: #3498db;
}
.promotion-card.type-3equals2 {
border-left-color: #f39c12;
}
.promotion-card.type-discount {
border-left-color: #e74c3c;
}
.card-header {
padding: 30px 25px;
color: white;
display: flex;
align-items: center;
gap: 20px;
}
.card-header.type-1plus1 {
background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
}
.card-header.type-3equals2 {
background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
}
.card-header.type-discount {
background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
}
.promotion-icon {
font-size: 3rem;
line-height: 1;
}
.promotion-info h2 {
font-size: 1.5rem;
margin-bottom: 5px;
}
.promotion-info p {
font-size: 0.95rem;
opacity: 0.9;
}
.card-body {
padding: 25px;
}
.card-body h3 {
color: #2c3e50;
margin-bottom: 15px;
font-size: 1.1rem;
display: flex;
align-items: center;
gap: 10px;
}
.item-list {
display: flex;
flex-direction: column;
gap: 12px;
padding-right: 10px;
}
.item-list.with-scroll {
max-height: 400px;
overflow-y: auto;
}
.item-list::-webkit-scrollbar {
width: 6px;
}
.item-list::-webkit-scrollbar-track {
background: #f1f1f1;
border-radius: 10px;
}
.item-list::-webkit-scrollbar-thumb {
background: #2ecc71;
border-radius: 10px;
}
.item {
background: #f8f9fa;
padding: 12px 15px;
border-radius: 8px;
border-left: 3px solid #2ecc71;
font-size: 0.95rem;
color: #34495e;
transition: all 0.3s;
}
.item:hover {
background: #ecf0f1;
transform: translateX(5px);
}
.item-header {
display: flex;
justify-content: space-between;
align-items: flex-start;
margin-bottom: 8px;
gap: 10px;
}
.item-name {
font-weight: 600;
flex: 1;
}
.discount-badge {
background: #f8f9fa;
color: #27ae60;
padding: 3px 8px;
border-radius: 4px;
font-size: 0.75rem;
font-weight: 700;
white-space: nowrap;
border: 1px solid #27ae60;
}
.item-prices {
display: flex;
justify-content: space-between;
gap: 15px;
font-size: 0.9rem;
color: #2c3e50;
padding-top: 8px;
border-top: 1px solid #dfe6e9;
}
.price-item {
display: flex;
flex-direction: column;
align-items: flex-start;
}
.price-label {
font-size: 0.75rem;
color: #7f8c8d;
text-transform: uppercase;
margin-bottom: 2px;
}
.price-value {
font-weight: 700;
color: #2ecc71;
font-size: 1rem;
}
.stats-row {
display: flex;
gap: 20px;
margin-top: 20px;
padding-top: 20px;
border-top: 1px solid #ecf0f1;
}
.stat-item {
flex: 1;
text-align: center;
}
.stat-item-value {
font-size: 1.5rem;
font-weight: 700;
color: #2ecc71;
}
.stat-item-label {
font-size: 0.8rem;
color: #7f8c8d;
margin-top: 5px;
text-transform: uppercase;
}
.empty-state {
background: white;
border-radius: 16px;
padding: 60px 40px;
text-align: center;
box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}
.empty-state-icon {
font-size: 4rem;
margin-bottom: 20px;
}
.empty-state h2 {
color: #2c3e50;
margin-bottom: 10px;
}
.empty-state p {
color: #7f8c8d;
font-size: 1rem;
}
.footer {
background: white;
border-radius: 12px;
padding: 30px;
text-align: center;
color: #7f8c8d;
font-size: 0.9rem;
margin-top: 40px;
box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}
.error-message {
background: #ffebee;
color: #c62828;
padding: 20px;
border-radius: 8px;
margin-bottom: 20px;
display: none;
border-left: 4px solid #c62828;
}
.print-tables {
display: none;
}
@keyframes slideDown {
from {
opacity: 0;
transform: translateY(-30px);
}
to {
opacity: 1;
transform: translateY(0);
}
}
@keyframes fadeIn {
from {
opacity: 0;
}
to {
opacity: 1;
}
}
@media print {
@page {
size: A4 landscape;
margin: 5mm;
}
body {
background: white;
padding: 0;
margin: 0;
}
.container {
max-width: 100%;
}
.header {
display: none;
}
.controls {
display: none;
}
.footer {
display: none;
}
.error-message {
display: none;
}
.promotions-grid {
display: none;
}
.print-tables {
display: block;
}
.promotion-section {
break-inside: avoid;
page-break-inside: avoid;
page-break-after: auto;
box-shadow: none;
margin-bottom: 2mm;
border: 0.5pt solid #999;
}
.promotion-section:last-child {
page-break-after: auto;
margin-bottom: 0;
}
.promotion-title {
padding: 3mm 4mm;
margin: 0;
break-inside: avoid;
display: flex;
align-items: center;
gap: 8mm;
}
.promotion-icon {
font-size: 11mm;
line-height: 1;
flex-shrink: 0;
}
.promotion-name {
flex: 1;
}
.promotion-name h2 {
font-size: 10pt;
margin: 0;
margin-bottom: 1mm;
font-weight: 700;
}
.promotion-name p {
font-size: 8pt;
margin: 0;
opacity: 0.9;
}
.table-wrapper {
padding: 2.5mm 3mm;
break-inside: avoid;
overflow: hidden;
}
table {
font-size: 9.5pt;
width: 100%;
border-collapse: collapse;
margin: 0;
table-layout: fixed;
line-height: 1.3;
}
table thead {
background: #f0f0f0 !important;
-webkit-print-color-adjust: exact;
print-color-adjust: exact;
}
table th {
padding: 2.5mm 2.5mm;
font-size: 8.5pt;
text-align: left;
font-weight: 700;
color: #2c3e50;
border-bottom: 1pt solid #2ecc71;
text-transform: uppercase;
-webkit-print-color-adjust: exact;
print-color-adjust: exact;
word-wrap: break-word;
overflow-wrap: break-word;
}
table td {
padding: 2mm 2.5mm;
font-size: 9pt;
border-bottom: 0.5pt solid #ddd;
color: #34495e;
word-wrap: break-word;
overflow-wrap: break-word;
}
table th:first-child,
table td:first-child {
width: 50%;
}
table th:nth-child(2),
table td:nth-child(2) {
width: 16.67%;
text-align: center;
}
table th:nth-child(3),
table td:nth-child(3) {
width: 16.67%;
text-align: right;
}
table th:nth-child(4),
table td:nth-child(4) {
width: 16.67%;
text-align: right;
}
table tbody tr:nth-child(odd) {
background: white !important;
-webkit-print-color-adjust: exact;
print-color-adjust: exact;
}
table tbody tr:last-child td {
border-bottom: 1pt solid #2ecc71;
}
.price-cell {
font-weight: 700;
color: #2ecc71;
-webkit-print-color-adjust: exact;
print-color-adjust: exact;
}
}
@media (max-width: 768px) {
.header {
padding: 25px;
}
.header h1 {
font-size: 1.8rem;
}
.header-logo {
flex-direction: column;
}
.promotions-grid {
grid-template-columns: 1fr;
}
.promotion-card {
border-left-width: 4px;
}
.card-header {
flex-direction: column;
text-align: center;
}
.promotion-icon {
font-size: 2.5rem;
}
.item-prices {
flex-direction: column;
gap: 10px;
}
.item-header {
flex-direction: column;
}
.controls {
flex-direction: column;
}
.filter-btn, .print-btn {
width: 100%;
}
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<div class="header-logo">
<div class="logo-img">
<img src="https://aloeapteka.ru/local/templates/aloe/favicon-600.png" alt="–õ–æ–≥–æ—Ç–∏–ø –ê–õ–û–≠">
</div>
<div>
<h1>–ê–∫—Ü–∏–∏ –°–¢–ú</h1>
</div>
</div>
<div class="header-stats">
<div class="stat-box">
<div class="stat-number" id="totalPromotions">3</div>
<div class="stat-label">–¢–∏–ø–æ–≤ –∞–∫—Ü–∏–π</div>
</div>
<div class="stat-box">
<div class="stat-number" id="totalItems">0</div>
<div class="stat-label">–ü–æ–∑–∏—Ü–∏–π</div>
</div>
</div>
</div>
<div class="error-message" id="errorMessage"></div>
<div class="controls">
<button class="filter-btn active" onclick="filterPromotions('all')">üìä –í—Å–µ –∞–∫—Ü–∏–∏</button>
<button class="filter-btn" onclick="filterPromotions('1plus1')">üéÅ 1+1</button>
<button class="filter-btn" onclick="filterPromotions('3equals2')">‚≠ê 3=2</button>
<button class="filter-btn" onclick="filterPromotions('discount')">üí∞ -50%</button>
<button class="print-btn" onclick="printPromotions()">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
</div>
<div class="promotions-grid" id="promotionsContainer">
<div class="empty-state">
<div class="empty-state-icon">‚è≥</div>
<h2>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</h2>
<p>–ò–¥—ë—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ç–∞–±–ª–∏—Ü–∞–º</p>
</div>
</div>
<div class="print-tables" id="printContainer"></div>
<div class="footer">
<strong>–ê–ø—Ç–µ—á–Ω–∞—è —Å–µ—Ç—å –ê–õ–û–≠</strong> | –ü–æ—Ä—Ç–∞–ª –∞–∫—Ü–∏–π –°–¢–ú
</div>
</div>
<script>
const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzXnw1HexNnwLKJ5usYCsH7Q0qJSvK2LD9REYU7S_eiTXx4cRe861oTk8fWCjkXJqfx7w/exec';
const CACHE_KEY = 'stmPromotionsCache';
const CACHE_TTL_MS = 24 * 60 * 60 * 1000;
let allData = {};
let currentFilter = 'all';
const promotionInfo = {
'1+1': {
icon: 'üéÅ',
description: '–ö—É–ø–∏ 1 - –ü–æ–ª—É—á–∏ 2',
color: 'type-1plus1',
savings: 50
},
'3=2': {
icon: '‚≠ê',
description: '–ö—É–ø–∏ 2 - –ü–æ–ª—É—á–∏ 3',
color: 'type-3equals2',
savings: 33
},
'-50% –Ω–∞ 2-—é —É–ø.': {
icon: 'üí∞',
description: '–°–∫–∏–¥–∫–∞ 50% –Ω–∞ –≤—Ç–æ—Ä—É—é —É–ø–∞–∫–æ–≤–∫—É',
color: 'type-discount',
savings: 25
}
};
async function loadData() {
try {
const cached = getCachedData();
if (cached) {
allData = cached;
renderPromotions('all');
generatePrintTables();
updateStats();
return;
}
const response = await fetch(GAS_WEB_APP_URL);
const data = await response.json();
if (data.error) {
showError('‚ùå –û—à–∏–±–∫–∞: ' + data.error);
return;
}
allData = data;
saveCache(data);
renderPromotions('all');
generatePrintTables();
updateStats();
} catch (e) {
showError('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + e.message);
console.error('–û—à–∏–±–∫–∞:', e);
}
}
function getCachedData() {
try {
const raw = localStorage.getItem(CACHE_KEY);
if (!raw) return null;
const parsed = JSON.parse(raw);
if (!parsed.timestamp || !parsed.data) return null;
const age = Date.now() - parsed.timestamp;
if (age > CACHE_TTL_MS) {
localStorage.removeItem(CACHE_KEY);
return null;
}
return parsed.data;
} catch (e) {
console.log('–ö—ç—à –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', e);
return null;
}
}
function saveCache(data) {
try {
const payload = {
timestamp: Date.now(),
data: data
};
localStorage.setItem(CACHE_KEY, JSON.stringify(payload));
} catch (e) {
console.log('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫—ç—à:', e);
}
}
function renderPromotions(filter = 'all') {
const container = document.getElementById('promotionsContainer');
const isAllFilter = filter === 'all';
container.innerHTML = '';
container.classList.toggle('single-view', !isAllFilter);
let hasContent = false;
Object.entries(allData.promotions || {}).forEach(([promo, items]) => {
if (filter !== 'all' && !promo.includes(getFilterKey(filter))) return;
if (!items.length) return;
hasContent = true;
const info = promotionInfo[promo];
const card = document.createElement('div');
card.className = `promotion-card ${info.color}`;
const scrollClass = isAllFilter ? 'with-scroll' : '';
card.innerHTML = `
<div class="card-header ${info.color}">
<div class="promotion-icon">${info.icon}</div>
<div class="promotion-info">
<h2>${promo}</h2>
<p>${info.description}</p>
</div>
</div>
<div class="card-body">
<h3>üì¶ –ü–æ–∑–∏—Ü–∏–∏ –≤ –∞–∫—Ü–∏–∏</h3>
<div class="item-list ${scrollClass}">
${items.map(item => `
<div class="item">
<div class="item-header">
<div class="item-name">${escapeHtml(item.nomenclature)}</div>
<div class="discount-badge">${info.savings}% —Å–∫–∏–¥–∫–∞</div>
</div>
<div class="item-prices">
<div class="price-item">
<span class="price-label">–ö–æ–º–ø–ª–µ–∫—Ç (${item.bundleSize} —à—Ç)</span>
<span class="price-value">${formatPrice(item.bundleSum)}</span>
</div>
<div class="price-item">
<span class="price-label">–ó–∞ —É–ø–∞–∫–æ–≤–∫—É</span>
<span class="price-value">${formatPrice(item.pricePerPackage)}</span>
</div>
</div>
</div>
`).join('')}
</div>
<div class="stats-row">
<div class="stat-item">
<div class="stat-item-value">${items.length}</div>
<div class="stat-item-label">–ü–æ–∑–∏—Ü–∏–π</div>
</div>
</div>
</div>
`;
container.appendChild(card);
});
if (!hasContent) {
container.innerHTML = `
<div class="empty-state" style="grid-column: 1 / -1;">
<div class="empty-state-icon">üì≠</div>
<h2>–ù–µ—Ç –∞–∫—Ü–∏–π –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ñ–∏–ª—å—Ç—Ä—É</h2>
<p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ç–∏–ø –∞–∫—Ü–∏–∏</p>
</div>
`;
}
}
function generatePrintTables() {
const printContainer = document.getElementById('printContainer');
printContainer.innerHTML = '';
Object.entries(allData.promotions || {}).forEach(([promo, items]) => {
if (!items.length) return;
const info = promotionInfo[promo];
const section = document.createElement('div');
section.className = `promotion-section ${info.color}`;
let tableRows = items.map(item => `
<tr>
<td>${escapeHtml(item.nomenclature)}</td>
<td>${item.bundleSize}</td>
<td class="price-cell">${formatPrice(item.bundleSum)}</td>
<td class="price-cell">${formatPrice(item.pricePerPackage)}</td>
</tr>
`).join('');
section.innerHTML = `
<div class="promotion-title" style="background: linear-gradient(135deg, ${getBackgroundGradient(info.color)} 100%); -webkit-print-color-adjust: exact; print-color-adjust: exact; color: white;">
<div class="promotion-icon">${info.icon}</div>
<div class="promotion-name">
<h2>${promo}</h2>
<p>${info.description}</p>
</div>
</div>
<div class="table-wrapper">
<table>
<thead>
<tr>
<th>–ü—Ä–µ–ø–∞—Ä–∞—Ç</th>
<th>–ö–æ–ª-–≤–æ</th>
<th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th>
<th>–ó–∞ —É–ø–∞–∫–æ–≤–∫—É</th>
</tr>
</thead>
<tbody>
${tableRows}
</tbody>
</table>
</div>
`;
printContainer.appendChild(section);
});
}
function getBackgroundGradient(color) {
const gradients = {
'type-1plus1': '#3498db 0%, #2980b9',
'type-3equals2': '#f39c12 0%, #e67e22',
'type-discount': '#e74c3c 0%, #c0392b'
};
return gradients[color] || '#2ecc71 0%, #27ae60';
}
function filterPromotions(filter) {
currentFilter = filter;
document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
event.target.classList.add('active');
renderPromotions(filter);
}
function getFilterKey(filter) {
const map = {
'1plus1': '1+1',
'3equals2': '3=2',
'discount': '-50%'
};
return map[filter] || filter;
}
function updateStats() {
const stats = allData.stats || {};
let total = 0;
Object.values(stats).forEach(s => total += s.count);
document.getElementById('totalItems').textContent = total;
}
function showError(msg) {
const errorDiv = document.getElementById('errorMessage');
errorDiv.textContent = msg;
errorDiv.style.display = 'block';
}
function printPromotions() {
window.print();
}
function escapeHtml(text) {
return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}
function formatPrice(value) {
if (!value || isNaN(value)) return '‚Äî';
return Math.round(value).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ') + ' ‚ÇΩ';
}
document.addEventListener('DOMContentLoaded', loadData);
</script>
</body>
</html>
